=== Glass Unit ===
id: types.env
version: 0.1.0
language: typescript

=== Intent ===
purpose: TypeScript type definitions for the Cloudflare Worker environment. Defines all runtime bindings (D1, R2, KV), secret variables, and Hono context types used throughout the application.
source:
  kind: ai-generated
  reference: "Cloudflare Workers runtime requirements"
parent: null
stakeholder: engineering
subIntents: []
approvalStatus: approved

=== Contract ===
requires:
  - "Cloudflare Worker runtime with D1, R2, and KV bindings"
  - "All secrets configured via wrangler secret put"
guarantees:
  on_success:
    - "Env interface defines all Worker bindings: DB (D1), MEDIA (R2), KV, ASSETS (Fetcher)"
    - "Env interface defines all secret strings: JWT_SECRET, GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET, TELEGRAM_BOT_TOKEN, TELEGRAM_WEBHOOK_SECRET, ANTHROPIC_API_KEY"
    - "Env interface defines configuration: ENVIRONMENT, ALLOWED_ORIGINS"
    - "Env interface defines optional configuration: ADMIN_EMAILS (comma-separated email addresses for auto-admin-promotion)"
    - "AppVariables defines userId and email set by auth middleware"
    - "AppContext combines Bindings and Variables for Hono generic type"
  on_failure:
    - "Missing bindings cause runtime errors at point of use"
invariants:
  - "ENVIRONMENT checked for 'production' to control security features"
  - "AppVariables only populated after auth middleware verification"
  - "All secret strings are non-empty when properly configured"
advisories:
  - "Missing bindings cause runtime errors at point of use â€” no dedicated error class needed for a pure types file"
